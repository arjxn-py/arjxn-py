I need to finish rewriting this.
